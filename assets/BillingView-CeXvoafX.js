import{a as _,h as u,i as X,j as Z,U as $,R as F,o as N,c as R,b as n,w as r,e as m,t as d,u as ee,G as ae,k as te,l as le,m as ne,n as ue,p as f,q as x,F as oe,s as se,L as t,v as B,x as re,y as ie,z as ge,B as _e,g as de,C as ce,H as me,I as fe,_ as pe}from"./index-CpTu4btR.js";const ve={style:{"margin-left":"5%","margin-right":"5%"}},w=3,S=2,be={__name:"Billing",props:{language:String,ruleset_id:String},setup(p){const e=p,v=_(!1),b=_({}),i=_([]),g=_(void 0),E=_(void 0),y=_(!1),T=_(0),V=u(()=>{if(e.language==t.CN)return"刷新数据";if(e.language==t.EN)return"Refresh"}),P=u(()=>{if(e.language==t.CN)return"统计范围";if(e.language==t.EN)return"Stats Range"}),A=u(()=>{if(e.language==t.CN)return"选手";if(e.language==t.EN)return"Player"}),G=u(()=>{if(e.language==t.CN)return"应付";if(e.language==t.EN)return"Payable"}),k=u(()=>{if(e.language==t.CN)return"八口场次";if(e.language==t.EN)return"AutoTable Games"}),L=u(()=>{if(e.language==t.CN)return"半庄收费";if(e.language==t.EN)return"Rate per Hanchan"}),U=u(()=>{if(e.language==t.CN)return"每月免费额度";if(e.language==t.EN)return"Free Games Per Month"}),q=u(()=>{if(e.language==t.CN)return"总应付";if(e.language==t.EN)return"Total Payable"}),I=u(()=>{if(e.language==t.CN)return"此规则没有配置后台数据库";if(e.language==t.EN)return"The Selected Ruleset Does Not Have Database"}),H=u(()=>{if(e.language==t.CN)return"只支持某一个月份计算";if(e.language==t.EN)return"Date Range Must Be In The Same Month"});u(()=>B[g.value]);function Y(a,l){return a.payable==0?"-":`$${a.payable}`}X(()=>{E.value=e.ruleset_id,g.value=e.ruleset_id}),Z(()=>{v.value==!1&&(i.value=j(),v.value=!0),D()});function O(a,l,o){return ee(`${ae}?action=get_stats&start_date=${a}&end_date=${l}&ruleset_id=${g.value}`).get().json().data}function D(){if(!$.has(g.value)){alert(`${I.value}: ${F[g.value][e.language]}`);return}g.value=E.value;const a=i.value[0],l=i.value[1],o=a.getFullYear()*1e4+(a.getMonth()+1)*100+a.getDate(),c=l.getFullYear()*1e4+(l.getMonth()+1)*100+l.getDate();if(a.getFullYear()!=l.getFullYear()||a.getMonth()!=l.getMonth()){alert(`${H.value}`);return}y.value=!0,b.value=O(o,c)}function j(){const a=new Date;return[new Date(a.getFullYear(),a.getMonth(),1),new Date(a.getFullYear(),a.getMonth()+1,0)]}const z=u(()=>{let a=[];if(!b.value||!b.value.value||!(g.value in B))return a;T.value=0;for(const l of b.value.value.stats){const o={name:`${l.player_name}`,game_equipment_auto8_count:l.game_equipment_count_map[re.AUTO8]};o.payable=Math.max(0,o.game_equipment_auto8_count-w)*S,T.value+=o.payable,a.push(o)}return y.value=!1,a});return(a,l)=>{const o=ie,c=te,h=le,M=ge,Q=fe,J=_e,K=de,C=ce,W=ne;return N(),R("div",null,[n(c,null,{default:r(()=>[n(o,null,{default:r(()=>[m(d(`${U.value}: ${w}`),1)]),_:1}),n(o,null,{default:r(()=>[m(d(`${L.value}: $${S}`),1)]),_:1})]),_:1}),n(h,null,{default:r(()=>[m(d(P.value),1)]),_:1}),n(c,{style:{"margin-bottom":"1%"}},{default:r(()=>[n(M,{modelValue:i.value[0],"onUpdate:modelValue":l[0]||(l[0]=s=>i.value[0]=s),type:"date",style:{width:"40%"}},null,8,["modelValue"]),ue("span",ve,d(f(x).TO[e.language]),1),n(M,{modelValue:i.value[1],"onUpdate:modelValue":l[1]||(l[1]=s=>i.value[1]=s),type:"date",style:{width:"40%"}},null,8,["modelValue"])]),_:1}),n(c,{style:{"margin-bottom":"1%"}},{default:r(()=>[n(J,{modelValue:E.value,"onUpdate:modelValue":l[2]||(l[2]=s=>E.value=s),filterable:"",style:{width:"40%"},placeholder:f(x).RULESET[e.language]},{default:r(()=>[(N(!0),R(oe,null,se(f($),s=>(N(),me(Q,{key:s,label:f(F)[s][p.language],value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),n(K,{type:"primary",disabled:y.value,onClick:D,style:{"margin-left":"5%"}},{default:r(()=>[m(d(y.value?f(x).LOADING[p.language]:V.value),1)]),_:1},8,["disabled"])]),_:1}),n(h),n(W,{data:z.value,style:{width:"100%"},stripe:"","table-layout":"auto"},{default:r(()=>[n(C,{fixed:"",prop:"name",label:A.value},null,8,["label"]),n(C,{prop:"game_equipment_auto8_count",label:k.value,sortable:""},null,8,["label"]),n(C,{prop:"payable",label:G.value,formatter:Y,sortable:""},null,8,["label"])]),_:1},8,["data"]),n(h),m(" "+d(`${q.value}: $${T.value}`),1)])}}},Ee={};function ye(p,e){const v=be;return N(),R("main",null,[n(v,{language:"CHINESE",ruleset_id:"THE_3Q1_LEAGUE"})])}const Te=pe(Ee,[["render",ye]]);export{Te as default};
